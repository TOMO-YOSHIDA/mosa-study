<!DOCTYPE html>
<html>
  <head>
    <title>変数のスコープ</title>
    <link rel="stylesheet" href="/mosa-study/study.css">
  </head>
  <body>
    <article>
      <h1>変数のスコープ</h1>
      <section>
        <h1>変数スコープを知る</h1>
        <div></div>
        <script title="変数のスコープは関数内" type="code/Javascript">
          var a = "A"; // 関数の外
          function fncB(){
          	var b = "B";
          	console.log(a); // aが見える
          	console.log(b); // bが見える
          };
          
          fncB(); // 関数を実行するとaが見える
          
          console.log(a); // aが見える
          console.log(b); // bが見えない(Uncaught ReferenceError: b is not defined(…))
          
        </script>
        <div>
          この結果を見ると、変数はその変数が宣言された関数の内側でのみ参照できることがわかります。
          また、fncB関数の内側では外側の変数aも参照できます。
          
        </div>
      </section>
      <section>
        <h1>varなし宣言はグローバル</h1>
        <div>
          Javascriptでは、varをつけずに変数を宣言することができます。
          しかし、プロならvarなし宣言は禁止です。
        </div>
        <div>なぜなら、varなしの宣言はグローバル変数となり、どこからでも参照できてしまうからです。</div>
        <div>どこからでも参照できる、ということはどこからでも書き換えられてしまいます。</div>
        <script title="varなしの場合はグローバル変数になる" type="code/Javascript">
          function A(){
          	a = "A"; //グローバル変数になる
          }
          
          function B(){
          	// B関数内では宣言していないけどグローバル変数aが見える！
          	console.log(a); // -> A
          	a = "not A";
          }
          
          function C(){
          	// ここではグローバル変数のaを参照する
          	console.log('c: "%s"', a); // -> c: "undefined"
          
          	// ローカル変数を宣言する
          	var a = 'a on c';
          	console.log('c: local a = "%s"', a); // -> c: local a = "a on c"
          
          	// 修飾子なしでaを変更しても、グローバル変数ではない
          	a = 'local a';
          	console.log('c: window.a = "%s"', window.a); // -> c: window.a = "not A"
          }
          
          A();
          B();
          C();
          
          // Aで宣言した変数がグローバルのため、B関数の中でaが書き換えられている
          console.log('a = "%s"', a); // -> a = "not A"
          
        </script>
        <div>
          いくら<code>var</code>をつけたとしても、関数外ではグローバル変数になります。
          
          
          
          
        </div>
      </section>
      <section>
        <h1>まとめ</h1>
        <ul>
          <li>var宣言無しではグローバル変数となる</li>
          <li>var宣言のスコープは関数の内側</li>
          <li>原則、varなしの変数宣言は禁止</li>
        </ul>
      </section>
      <footer>
        <hr>
        <div class="writer">
          <!-- div.title 書いた人-->
          <div class="person">
            <!-- 表示情報-->
            <div class="name">日帰りキャンパー</div>
            <!-- 経歴とか-->
            <div class="description">
              2012年7月入社。猫派。
              マイブームはJavascript, TypeScript, CSS3, HTML5。
            </div>
          </div>
        </div>
        <div class="space"></div>
        <div class="flex-center"><a href="/mosa-study" class="btn">HOME</a></div>
        <div class="space"></div>
      </footer>
    </article>
    <script src="/mosa-study/lib.min.js"></script>
    <script>
      CodeHighlight.execute();
      
      !function(g){
      	var f = function(){};
      	g.console = g.console || {log:f, debug:f, error:f}
      
      	// assertを提供する
      	g.assert = function(val, msg) {
      		if(!!val)
      			console.log('成功：%s, %s', val, msg);
      		else
      			console.error('失敗：%s, %s', val, msg);
      	}
      }(this);
    </script>
  </body>
</html>